\documentclass[a4paper, 10pt, titlepage]{article}
%=======Unpackage Things===============
\usepackage{color}
\usepackage{colortbl}
\usepackage{mathrsfs}
\usepackage{hyperref}

\usepackage{graphicx}
\usepackage{amsthm}
\usepackage{listings}
%\usepackage{fullpage}
\usepackage{epsfig}
\usepackage{amsmath}
\usepackage{latexsym}
\usepackage{amssymb}
\usepackage{amstext}
\usepackage{array}
\usepackage{titlesec}
\usepackage{float}

\titleformat{\section}
    {\normalfont\fontsize{12}{13}\bfseries}{\thesection}
    {1em}{}

%\titleformat{\subsection}
%    {\normalfont\fontsize{5}{5}\bfseries}{\thesection}
%    {1em}{}
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}


\begin{document}
%==title==
\title{COMP6321 Assignment 4}
\setcounter{tocdepth}{2}
\newpage
\begin{center}
    {\huge COMP6321: Assignment \#4}


    \vspace{2cm}
    Student: Qing Gu  \hspace{5cm}
    Student ID: 6935451
    \vspace{1cm}

    =================================================
\end{center}
\section{VC Dimension}
\begin{enumerate}
    \item $VC(H)=1$, since we can always shatter the subset with 1 points.
        \begin{center}
        \begin{picture}(100,60)
        \put(10,60){$-$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        \put(50,45){\line(0,1){10}}
        \put(50,55){\line(1,0){5}}
        \put(50,45){\line(1,0){5}}
        \end{picture}
        \end{center}

        \begin{center}
        \begin{picture}(100,20)
        \put(70,60){$-$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        \put(50,45){\line(0,1){10}}
        \put(50,55){\line(1,0){5}}
        \put(50,45){\line(1,0){5}}
        \end{picture}
        \end{center}
    But we can not do that when there are two points. When there is a dichotomy like this:
        \begin{center}
        \begin{picture}(100,60)
        \put(70,60){$-$}
        \put(10,60){$+$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        %\put(50,45){\line(0,1){10}}
        %\put(50,55){\line(1,0){5}}
        %\put(50,45){\line(1,0){5}}
        \end{picture}
        \end{center}

    \item $VC(H)=2$, we can find configuration for two points.
        \begin{center} 
        \begin{picture}(100,60)
        \put(10,60){$-$}
        \put(70,60){$+$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        \put(50,45){\line(0,1){10}}
        \put(50,55){\line(1,0){5}}
        \put(50,45){\line(1,0){5}}
        \end{picture}

        \begin{picture}(100,20)
        \put(10,60){$+$}
        \put(70,60){$+$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        \put(5,45){\line(0,1){10}}
        \put(5,55){\line(1,0){5}}
        \put(5,45){\line(1,0){5}}
        \end{picture}

        \begin{picture}(100,20)
        \put(10,60){$-$}
        \put(70,60){$-$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        \put(80,45){\line(0,1){10}}
        \put(80,55){\line(1,0){5}}
        \put(80,45){\line(1,0){5}}
        \end{picture}

        \begin{picture}(100,20)
        \put(10,60){$+$}
        \put(70,60){$-$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        \put(30,45){\line(0,1){10}}
        \put(25,55){\line(1,0){5}}
        \put(25,45){\line(1,0){5}}
        \end{picture}
        \end{center}
        But for this configuration with 3 points, we can not shatter it.
        \begin{center}
        \begin{picture}(100,60)
        \put(10,60){$+$}
        \put(40,60){$-$}
        \put(70,60){$+$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        \end{picture}
        \end{center}


    \item $VC(H)=2$. For dichotomy of 2 points, it can be shattered like the example above. For dichotomy of 3 points, we can find a configuration that can not be shattered no matter how many one-sided unions we union. 
        \begin{center}
        \begin{picture}(100,60)
        \put(10,60){$-$}
        \put(40,60){$+$}
        \put(70,60){$-$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        \end{picture}
        \end{center}

    \item $VC(H) = 4$. This situation can be interpret as find a configuration that can split positive dots in maximum 2 intervals. If there are 4 points, the maximum number of intervals that the positive points can be split to put in is 2. Thus, we can fit this situation in union of two closed intervals.

        Otherwise, when there are 5 points, there exists a configuration that splits positive points into 3 intervals.
        \begin{center}
        \begin{picture}(100,60)
        \put(10,60){$+$}
        \put(30,60){$-$}
        \put(50,60){$+$}
        \put(70,60){$-$}
        \put(90,60){$+$}
        \put(0,50){\line(1,0){100}}
        \multiput(10,50)(10,0){9}{\line(0,1){5}}
        \multiput(10,40)(10,0){9}%{\makebox(0,0){\thenn\stepcounter{nn}}}
        \thicklines
        \put(20,50){\circle{3}}
        \put(80,50){\circle{3}}
        \linethickness{1pt}
        \end{picture}
    \end{center}
    In the example above, the positive points are split into 3 uncontinuous intervals, which can not be fitted in 2 intervals. 
    \item $VC(H)=2k$. This is an expansion of previous problem. Considering we have $k$ continuous intervals and $2k$ points. The maximum number of intervals that we can shatter the positive points into is $k$, which is achieved by insert a negative point between two positive points. This situation, absolutely, can be shattered by $k$ intervals.

        If we have $2k+1$ points to shatter, there is a configuration to shatter positive points into $k+1$ intervals, like the previous question whose $k$ is 2, which is not possible to fit in $k$ intervals.


\end{enumerate}
\section{KL-Divergence}
\begin{enumerate}
    \item There are two ways to prove it.

        \begin{itemize}
                \item Method 1:

                    Let random variable $f(x) = \frac{Q(x)}{P(x)}$ Then we can rewrite KL Divergence to the expectation of $f(x)$ whose probability is $P(x)$
                    $$KL(P||Q) = -E_p[\log{f(x)}] $$
                    $$\geq-\log{E_p[f(x)]}\mbox{~(Jensen's inequality)}$$
                    $$=-\log{\sum_xP(x)\frac{Q(X)}{P(X)}}=0$$
                    Thus, $KL(P||Q) \geq 0$.

                \item Method 2:
                    $$-KL(P||Q) = \sum_xP(x)\log{\frac{Q}{P}}$$
                    $$\because \log{x}\leq{}x-1$$
                    $$\therefore -KL(P||Q)\leq\sum_x(\frac{Q(x)}{P(x)}-1)$$
                    $$-KL(P||Q)=\sum_xQ(x)-sum_xP(x)$$
                    $$\because P(x)\mbox{~is an distribution function}$$
                    $$\therefore -KL(P||Q) \leq \sum_xQ(x)-1 \leq 0$$
                    Thus, $KL(P||Q) \geq 0$.
        \end{itemize}
    \item From above, we can observe that when $P(x) = Q(x)$, $KL(P||Q) = 0$
    \item The maximum value of KL divergence is $+\infty$. When for any $x_i$, $Q(x_i)=0$, then $\log{\frac{Q(x)}{P(x)}} = +\infty$, $KL(P||Q) = +\infty$. 
    \item KL divergence is not symmetric. 
    \item   The equation is proved from right. According to definition:
        \begin{align*}
         KL(P(X,Y)||Q(X,Y))&=\sum_x\sum_yP(X,Y)log\frac{P(X,Y)}{Q(X,Y)}\\ 
         &=\sum_x\sum_yP(X,Y)log\frac{P(Y|X)P(X)}{Q(Y|X)Q(X)}\mbox{~(Chain rule)}\\ 
         &= \sum_x\sum_yP(X,Y)log\frac{P(Y|X)}{Q(Y|X)}+\sum_x\sum_yP(X,Y)log\frac{P(X)}{Q(X)}\\ 
         &= \sum_x\sum_yP(Y|X)P(X)log\frac{P(Y|X)}{Q(Y|X)}+KL(P(X)||Q(X))\\ 
         &= \sum_xP(X)\sum_yP(Y|X)log\frac{P(Y|X)}{Q(Y|X)}+KL(P(X)||Q(X))\\ 
         &= KL(P(Y|X)||Q(Y|X))+KL(P(X)||Q(X))\\
         QED
        \end{align*}
    \item In this problem, we'd like to find parameter $\theta$ to maximize the distribution $P_\theta(x) =P(x|\theta)$. Let $\hat{P}$ be the empirical distribution, we have:
        \begin{align*} 
        KL(\hat{P}||P_\theta)&=\sum_x\hat{P}\log\frac{\hat{P}}{P_\theta}\\
        &=\sum_x\hat{P}\log\hat{P}-\sum_x\hat{P}\log{P_\theta}\\
        &=-H(\hat{X})-\sum_x\hat{P}\log{P_\theta}
        \end{align*}
        Since $H(\hat{X})$ and $\hat{P}$ are irelevant with $\theta$ and are all greater or equal to 0, therefore,
        $$\arg{\min_\theta}KL(\hat{P}||P_\theta)=\arg{\max_\theta}\sum_x\log{P_\theta}$$
        QED
\section{K-means}
    \begin{itemize}
        \item 6 Clusters are left in the end
        \item Final centeroids Table 1
        \item Number of pixels associate to each centeroid Table 1
            \begin{table}[H]
            \center
            \begin{tabular}{cccc}
            R       & G       & B       & \#Pixels \\ \hline
            241.230 & 238.625 & 233.863 & 4930    \\
            194.412 & 136.333 & 90.939  & 15190   \\
            136.266 & 61.090  & 10.104  & 52535   \\
            157.290 & 97.592  & 51.434  & 22075   \\
            78.927  & 37.108  & 13.071  & 40365   \\
            25.978  & 23.236  & 23.606  & 74917   \\
            \end{tabular}
            \label{pixel}
            \caption{Centeroids}
        \end{table}
    \item There are 47 iterations, the distance from each centeroid to its correspondent pixels are stored in \href{./out.txt}{out.txt}
    \item Result of images can be seen by running \emph{imageViewer.py}. This script can display images and store them in eps file.
        \begin{figure}[H]
    \begin{minipage}{0.49\linewidth}
            \includegraphics[width=6cm]{origin.eps}
      \caption{Original Picture}\label{fig:left}
    \end{minipage}
    \hfill
    \begin{minipage}{0.49\linewidth}
            \includegraphics[width=6cm]{clustered.eps}
      \caption{Clustered Picture}\label{fig:right}
    \end{minipage}
  \end{figure}
    \end{itemize}
\section{K-medoids}
\begin{itemize}
    \item $\mathfrak{Advantages}$
        \begin{enumerate}
            \item K-medoids is more robust to noise and outliers.
            \item It is more suitable to desecrate dataset. For the color clustering above, it would be more suitable to use k-medoids to keep the colors in integers. 

        \end{enumerate}
    \item $\mathfrak{Disadvantages}$
        \begin{enumerate}
            \item K-medoids is harder than K-means, i.e. its time complexity is higher than K-meas.
            \item Less efficient, converge slower than K-means.
            \item More difficult to implement. 

        \end{enumerate}
\end{itemize}
    
                    


                
\end{enumerate}


\end{document}
